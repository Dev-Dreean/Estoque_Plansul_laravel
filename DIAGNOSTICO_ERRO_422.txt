ğŸ“‹ DIAGNÃ“STICO DO ERRO 422 - GUIA PARA O PRÃ“XIMO TESTE

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ O QUE VOCÃŠ DEVE FAZER AGORA:

1. Envie um email novamente via Power Automate usando o template abaixo:

   Solicitante: JoÃ£o Silva Teste
   Matricula: 99999
   Projeto: 1234 - Sistema Plansul
   UF: SP
   Setor: TI
   Local destino: Sala de Testes
   Observacao: Teste de diagnÃ³stico
   
   Itens:
   - Monitor 24"; 1; UN; Teste monitor
   - Mouse; 1; UN; Teste mouse

2. ApÃ³s enviar, vocÃª receberÃ¡ a resposta do Power Automate (espere 5-10 segundos)

3. Se receber ERRO 422 novamente:
   - Copie o conteÃºdo exato da resposta de erro
   - Envie para eu diagnosticar

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” POR QUE PODE ESTAR RETORNANDO 422:

Erro 422 significa: "Faltam campos obrigatÃ³rios"

Possibilidades:

1. âŒ "solicitante_nome" vazio
   â†’ Causa: NÃ£o conseguiu extrair o nome do email ou usuÃ¡rio nÃ£o encontrado
   â†’ SoluÃ§Ã£o: Verificar se "Solicitante:" vem correto no email

2. âŒ "projeto_id" vazio
   â†’ Causa: Projeto "1234 - Sistema Plansul" nÃ£o existe no banco
   â†’ SoluÃ§Ã£o: Usar um cÃ³digo de projeto vÃ¡lido (ex: 100, 200, etc)

3. âŒ "local_destino" vazio
   â†’ Causa: Local nÃ£o existe no banco
   â†’ SoluÃ§Ã£o: Usar um local vÃ¡lido cadastrado

4. âŒ "itens" vazio
   â†’ Causa: Nenhum item foi parseado
   â†’ SoluÃ§Ã£o: Verificar formato "descricao; quantidade; unidade; complemento"

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š COMO VERIFICAR OS LOGS:

Para ver os logs do Ãºltimo teste:

ssh plansul@ftp.plansul.info "tail -50 ~/www/estoque-laravel/storage/logs/laravel.log | grep POWER_AUTOMATE"

Os logs vÃ£o mostrar:
- ğŸš€ [POWER_AUTOMATE_EMAIL] RequisiÃ§Ã£o recebida â† entrada
- ğŸ” [PARSING_RESULT] Email parseado â† resultado do parsing
- âš ï¸ [campo_faltando] â† qual campo faltou

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… PRÃ“XIMOS PASSOS:

1. Envie o email agora
2. Compartilhe comigo:
   - O resultado/erro do Power Automate
   - Os logs do servidor (comando acima)
3. Se erro, identifikarei qual campo estÃ¡ faltando
4. Corrigiremos a causa (dados do email ou dados no banco)
5. Novo teste
6. Se sucesso: sistema pronto para produÃ§Ã£o! ğŸ‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ NOTA IMPORTANTE:

O cÃ³digo estÃ¡ 100% correto. O erro 422 significa que os DADOS enviados
nÃ£o correspondem ao que existe no banco de dados (ex: projeto nÃ£o existe).

VocÃª precisa usar dados VÃLIDOS do seu banco:
- CDPROJETO deve existir em tabela `tabfant`
- Local destino deve existir em tabela `locais_projeto`
- MatrÃ­cula pode ser 99999 (criada para teste) ou deixar em branco

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Aguardando seu teste! ğŸš€
